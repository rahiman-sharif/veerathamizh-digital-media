<%- include('../../layouts/header') %>

<div class="container">
    <div class="row justify-content-center">        <div class="col-md-8">
            <div class="form-container my-5 fade-in">
                <div class="text-center mb-4">
                    <div class="auth-logo-container mb-3">
                        <img src="/images/banner.png" alt="Veerathamizh Digital Media" class="auth-banner">
                    </div>
                </div>
                <h2 class="form-title">Create an Account</h2>
                
                <form action="/auth/register" method="POST" class="needs-validation" novalidate>
                    <div class="row">
                        <!-- Personal Information -->
                        <h5 class="mb-3">Personal Information</h5>
                        
                        <div class="col-md-6 mb-3">
                            <label for="first_name" class="form-label">First Name*</label>
                            <input type="text" class="form-control" id="first_name" name="first_name" required>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="last_name" class="form-label">Last Name*</label>
                            <input type="text" class="form-control" id="last_name" name="last_name" required>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="email" class="form-label">Email Address*</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label">Phone Number*</label>
                            <input type="tel" class="form-control" id="phone" name="phone" required>
                        </div>
                        
                        <!-- Company Information -->
                        <h5 class="mb-3 mt-4">Company Information</h5>
                        
                        <div class="col-md-6 mb-3">
                            <label for="company_name" class="form-label">Company Name*</label>
                            <input type="text" class="form-control" id="company_name" name="company_name" required>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="company_address" class="form-label">Company Address*</label>
                            <input type="text" class="form-control" id="company_address" name="company_address" required>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="city" class="form-label">City*</label>
                            <input type="text" class="form-control" id="city" name="city" required>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="state" class="form-label">State*</label>
                            <select class="form-select" id="state" name="state" required>
                                <option value="" selected disabled>Select State</option>
                                <option value="Tamil Nadu">Tamil Nadu</option>
                                <option value="Kerala">Kerala</option>
                                <option value="Karnataka">Karnataka</option>
                                <option value="Andhra Pradesh">Andhra Pradesh</option>
                                <option value="Telangana">Telangana</option>
                                <!-- Add more states as needed -->
                            </select>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="zipcode" class="form-label">Zipcode*</label>
                            <input type="text" class="form-control" id="zipcode" name="zipcode" required>
                        </div>                        <div class="col-md-6 mb-3">
                            <label for="zone" class="form-label">Zone</label>
                            <select class="form-select" id="zone" name="zone">
                                <option value="" selected disabled>Select Zone</option>
                                <option value="North">North</option>
                                <option value="South">South</option>
                                <option value="East">East</option>
                                <option value="West">West</option>
                                <option value="Central">Central</option>
                            </select>
                        </div>
                          <input type="hidden" name="user_type" value="User">
                        
                        <!-- Password -->
                        <h5 class="mb-3 mt-4">Set Password</h5>
                        
                        <div class="col-md-6 mb-3">
                            <label for="password" class="form-label">Password*</label>
                            <input type="password" class="form-control" id="password" name="password" required>
                            <small class="text-muted">7-16 characters, at least 1 uppercase, 1 lowercase, 1 number. Special characters @#$%^&*! allowed.</small>
                        </div>
                          <div class="col-md-6 mb-3">
                            <label for="confirm_password" class="form-label">Confirm Password*</label>
                            <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                            <div id="confirm-password-error" class="invalid-feedback" style="display: none;">
                                Passwords do not match
                            </div>
                        </div>
                          <div class="col-12 mb-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="terms" name="terms" required>
                                <label class="form-check-label" for="terms">
                                    I agree to the <a href="#" class="text-decoration-none" data-toggle="terms">Terms and Conditions</a>
                                </label>
                            </div>
                        </div>
                        
                        <div class="col-12 mt-4">
                            <div class="d-grid">
                                <button type="submit" class="btn btn-primary btn-lg">Create Account</button>
                            </div>
                        </div>
                        
                        <div class="col-12 mt-3 text-center">
                            <p>Already have an account? <a href="/auth/login" class="text-decoration-none">Log In</a></p>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Password match validation function
    function validatePasswordMatch() {
        const password = document.getElementById('password').value;
        const confirmPassword = document.getElementById('confirm_password').value;
        const confirmPasswordField = document.getElementById('confirm_password');
        const errorDiv = document.getElementById('confirm-password-error');
        
        if (confirmPassword.length > 0) {
            if (password === confirmPassword) {
                confirmPasswordField.classList.remove('is-invalid');
                confirmPasswordField.classList.add('is-valid');
                errorDiv.style.display = 'none';
            } else {
                confirmPasswordField.classList.remove('is-valid');
                confirmPasswordField.classList.add('is-invalid');
                errorDiv.style.display = 'block';
            }
        } else {
            // Reset validation state when confirm password is empty
            confirmPasswordField.classList.remove('is-valid', 'is-invalid');
            errorDiv.style.display = 'none';
        }
    }
    
    // Password validation with detailed feedback
    document.getElementById('password').addEventListener('input', function() {
        const password = this.value;
        const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d@#$%^&*!]{7,16}$/;
        
        // Individual checks for better debugging
        const hasLowercase = /(?=.*[a-z])/.test(password);
        const hasUppercase = /(?=.*[A-Z])/.test(password);
        const hasDigit = /(?=.*\d)/.test(password);
        const isValidLength = password.length >= 7 && password.length <= 16;
        const hasOnlyValidChars = /^[a-zA-Z\d@#$%^&*!]*$/.test(password);
        
        // Log details for debugging (remove in production)
        console.log('Password validation:', {
            password: password,
            hasLowercase: hasLowercase,
            hasUppercase: hasUppercase,
            hasDigit: hasDigit,
            isValidLength: isValidLength,
            hasOnlyValidChars: hasOnlyValidChars,
            overallValid: regex.test(password)
        });
        
        if (regex.test(password)) {
            this.classList.remove('is-invalid');
            this.classList.add('is-valid');
        } else {
            this.classList.remove('is-valid');
            this.classList.add('is-invalid');
        }
        
        // Re-validate password match when password changes
        validatePasswordMatch();
    });
    
    // Password confirmation validation
    document.getElementById('confirm_password').addEventListener('input', validatePasswordMatch);    document.getElementById('confirm_password').addEventListener('blur', validatePasswordMatch);
</script>

<%- include('../../layouts/footer') %>
